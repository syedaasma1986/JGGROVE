/*! adapterjs - v0.13.4 - 2016-09-22 */

function GetPluginLocation(){var e="";try{var e=webphone_api.getbasedir2();if(typeof e=="undefined"||e===null)e="";return e.charAt(e.length-1)!=="/"&&(e+="/"),e+="native/webrtcplugin.pkg",console&&console.log&&console.log("webphone: adapter.js GetPluginLocation: "+e),e}catch(t){try{console.log("ERROR, adapter.js: GetPluginLocation: "+t)}catch(n){}}return"http://bit.ly/1n77hco"}var isdebugversion=!1,plugininstalltext="This website requires you to install the WebRTC Plugin to work on this browser.",macdownloadurl=GetPluginLocation(),windownloadurl="",AdapterJS=AdapterJS||{};typeof exports!="undefined"&&(module.exports=AdapterJS),AdapterJS.options=AdapterJS.options||{},AdapterJS.VERSION="0.13.4",AdapterJS.onwebrtcready=AdapterJS.onwebrtcready||function(e){},AdapterJS._onwebrtcreadies=[],AdapterJS.webRTCReady=function(e){if(typeof e!="function")throw new Error("Callback provided is not a function");!0===AdapterJS.onwebrtcreadyDone?e(null!==AdapterJS.WebRTCPlugin.plugin):AdapterJS._onwebrtcreadies.push(e)},AdapterJS.WebRTCPlugin=AdapterJS.WebRTCPlugin||{},AdapterJS.WebRTCPlugin.pluginInfo=AdapterJS.WebRTCPlugin.pluginInfo||{prefix:"Tem",plugName:"TemWebRTCPlugin",pluginId:"plugin0",type:"application/x-temwebrtcplugin",onload:"__TemWebRTCReady0",portalLink:"http://skylink.io/plugin/",downloadLink:null,companyName:"Temasys",downloadLinks:{mac:macdownloadurl,win:windownloadurl}},typeof AdapterJS.WebRTCPlugin.pluginInfo.downloadLinks!="undefined"&&AdapterJS.WebRTCPlugin.pluginInfo.downloadLinks!==null&&(navigator.platform.match(/^Mac/i)?AdapterJS.WebRTCPlugin.pluginInfo.downloadLink=AdapterJS.WebRTCPlugin.pluginInfo.downloadLinks.mac:!navigator.platform.match(/^Win/i)||(AdapterJS.WebRTCPlugin.pluginInfo.downloadLink=AdapterJS.WebRTCPlugin.pluginInfo.downloadLinks.win)),AdapterJS.WebRTCPlugin.TAGS={NONE:"none",AUDIO:"audio",VIDEO:"video"},AdapterJS.WebRTCPlugin.pageId=Math.random().toString(36).slice(2),AdapterJS.WebRTCPlugin.plugin=null,AdapterJS.WebRTCPlugin.setLogLevel=null,AdapterJS.WebRTCPlugin.defineWebRTCInterface=null,AdapterJS.WebRTCPlugin.isPluginInstalled=null,AdapterJS.WebRTCPlugin.pluginInjectionInterval=null,AdapterJS.WebRTCPlugin.injectPlugin=null,AdapterJS.WebRTCPlugin.PLUGIN_STATES={NONE:0,INITIALIZING:1,INJECTING:2,INJECTED:3,READY:4},AdapterJS.WebRTCPlugin.pluginState=AdapterJS.WebRTCPlugin.PLUGIN_STATES.NONE,AdapterJS.onwebrtcreadyDone=!1,AdapterJS.WebRTCPlugin.PLUGIN_LOG_LEVELS={NONE:"NONE",ERROR:"ERROR",WARNING:"WARNING",INFO:"INFO",VERBOSE:"VERBOSE",SENSITIVE:"SENSITIVE"},AdapterJS.WebRTCPlugin.WaitForPluginReady=null,AdapterJS.WebRTCPlugin.callWhenPluginReady=null,__TemWebRTCReady0=function(){if(document.readyState==="complete")AdapterJS.WebRTCPlugin.pluginState=AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY,AdapterJS.maybeThroughWebRTCReady();else var e=setInterval(function(){document.readyState==="complete"&&(clearInterval(e),AdapterJS.WebRTCPlugin.pluginState=AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY,AdapterJS.maybeThroughWebRTCReady())},100)},AdapterJS.maybeThroughWebRTCReady=function(){AdapterJS.onwebrtcreadyDone||(AdapterJS.onwebrtcreadyDone=!0,AdapterJS._onwebrtcreadies.length?AdapterJS._onwebrtcreadies.forEach(function(e){typeof e=="function"&&e(AdapterJS.WebRTCPlugin.plugin!==null)}):typeof AdapterJS.onwebrtcready=="function"&&AdapterJS.onwebrtcready(AdapterJS.WebRTCPlugin.plugin!==null))},AdapterJS.TEXT={PLUGIN:{REQUIRE_INSTALLATION:"This website requires you to install a WebRTC-enabling plugin to work on this browser.",NOT_SUPPORTED:"Your browser does not support WebRTC.",BUTTON:"Install Now"},REFRESH:{REQUIRE_REFRESH:"Please refresh page",BUTTON:"Refresh Page"}},AdapterJS._iceConnectionStates={starting:"starting",checking:"checking",connected:"connected",completed:"connected",done:"completed",disconnected:"disconnected",failed:"failed",closed:"closed"},AdapterJS._iceConnectionFiredStates=[],AdapterJS.isDefined=null,AdapterJS.parseWebrtcDetectedBrowser=function(){var e=null;!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0?(webrtcDetectedBrowser="opera",webrtcDetectedType="webkit",webrtcMinimumVersion=26,e=/OPR\/(\d+)/i.exec(navigator.userAgent)||[],webrtcDetectedVersion=parseInt(e[1],10)):typeof InstallTrigger!="undefined"?webrtcDetectedType="moz":Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0?(webrtcDetectedBrowser="safari",webrtcDetectedType="plugin",webrtcMinimumVersion=7,e=/version\/(\d+)/i.exec(navigator.userAgent)||[],webrtcDetectedVersion=parseInt(e[1],10)):document.documentMode?(webrtcDetectedBrowser="IE",webrtcDetectedType="plugin",webrtcMinimumVersion=9,e=/\brv[ :]+(\d+)/g.exec(navigator.userAgent)||[],webrtcDetectedVersion=parseInt(e[1]||"0",10),webrtcDetectedVersion||(e=/\bMSIE[ :]+(\d+)/g.exec(navigator.userAgent)||[],webrtcDetectedVersion=parseInt(e[1]||"0",10))):window.StyleMedia?webrtcDetectedType="":!window.chrome||!window.chrome.webstore?(webrtcDetectedBrowser==="chrome"||webrtcDetectedBrowser==="opera")&&!!window.CSS&&(webrtcDetectedBrowser="blink"):webrtcDetectedType="webkit",(navigator.userAgent.match(/android/ig)||[]).length===0&&(navigator.userAgent.match(/chrome/ig)||[]).length===0&&navigator.userAgent.indexOf("Safari/")>0&&(webrtcDetectedBrowser="safari",webrtcDetectedVersion=parseInt((navigator.userAgent.match(/Version\/(.*)\ /)||["","0"])[1],10),webrtcMinimumVersion=7,webrtcDetectedType="plugin"),window.webrtcDetectedBrowser=webrtcDetectedBrowser,window.webrtcDetectedVersion=webrtcDetectedVersion,window.webrtcMinimumVersion=webrtcMinimumVersion},AdapterJS.addEvent=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e[t]=n},AdapterJS.renderNotificationBar=function(e,t,n,r,i){if(document.readyState!=="complete")return;var s=window,o=document.createElement("iframe");o.name="adapterjs-alert",o.style.position="fixed",o.style.top="-41px",o.style.left=0,o.style.right=0,o.style.width="100%",o.style.height="80px",o.style.backgroundColor="#fcd163",o.style.border="none",o.style.borderBottom="1px solid #888888",o.style.zIndex="9999999",typeof o.style.webkitTransition=="string"?o.style.webkitTransition="all .5s ease-out":typeof o.style.transition=="string"&&(o.style.transition="all .5s ease-out"),document.body.appendChild(o);var u=o.contentWindow?o.contentWindow:o.contentDocument.document?o.contentDocument.document:o.contentDocument;u.document.open(),u.document.write('<span style="display: inline-block; font-family: Helvetica, Arial,sans-serif; font-size: .9rem; padding: 4px; vertical-align: middle; cursor: default;">'+e+"</span>"),t&&n?(u.document.write('<button id="okay">'+t+'</button><button id="cancel">Cancel</button>'),u.document.close(),AdapterJS.addEvent(u.document.getElementById("okay"),"click",function(e){!i||AdapterJS.renderNotificationBar(AdapterJS.TEXT.EXTENSION?AdapterJS.TEXT.EXTENSION.REQUIRE_REFRESH:AdapterJS.TEXT.REFRESH.REQUIRE_REFRESH,AdapterJS.TEXT.REFRESH.BUTTON,"javascript:location.reload()"),window.open(n,r?"_blank":"_top"),e.preventDefault();try{e.cancelBubble=!0}catch(t){}var s=setInterval(function(){isIE||navigator.plugins.refresh(!1),AdapterJS.WebRTCPlugin.isPluginInstalled(AdapterJS.WebRTCPlugin.pluginInfo.prefix,AdapterJS.WebRTCPlugin.pluginInfo.plugName,AdapterJS.WebRTCPlugin.pluginInfo.type,function(){clearInterval(s),AdapterJS.WebRTCPlugin.defineWebRTCInterface()},function(){})},500)}),AdapterJS.addEvent(u.document.getElementById("cancel"),"click",function(e){s.document.body.removeChild(o)})):u.document.close(),setTimeout(function(){typeof o.style.webkitTransform=="string"?o.style.webkitTransform="translateY(40px)":typeof o.style.transform=="string"?o.style.transform="translateY(40px)":o.style.top="0px"},300)},webrtcDetectedType=null,checkMediaDataChannelSettings=function(e,t,n,r){if(typeof n!="function")return;var i=!0,s=webrtcDetectedBrowser==="firefox",o=webrtcDetectedType==="moz"&&webrtcDetectedVersion>30,u=e==="firefox",a=e==="firefox"&&(t?t>30:!1);if(s&&u||o)try{delete r.mandatory.MozDontOfferDataChannel}catch(f){console.error("Failed deleting MozDontOfferDataChannel"),console.error(f)}else s&&!u&&(r.mandatory.MozDontOfferDataChannel=!0);if(!s)for(var l in r.mandatory)r.mandatory.hasOwnProperty(l)&&l.indexOf("Moz")!==-1&&delete r.mandatory[l];s&&!u&&!o&&(i=!1),n(i,r)},checkIceConnectionState=function(e,t,n){if(typeof n!="function"){console.warn("No callback specified in checkIceConnectionState. Aborted.");return}e=e?e:"peer";if(!AdapterJS._iceConnectionFiredStates[e]||t===AdapterJS._iceConnectionStates.disconnected||t===AdapterJS._iceConnectionStates.failed||t===AdapterJS._iceConnectionStates.closed)AdapterJS._iceConnectionFiredStates[e]=[];t=AdapterJS._iceConnectionStates[t],AdapterJS._iceConnectionFiredStates[e].indexOf(t)<0&&(AdapterJS._iceConnectionFiredStates[e].push(t),t===AdapterJS._iceConnectionStates.connected&&setTimeout(function(){AdapterJS._iceConnectionFiredStates[e].push(AdapterJS._iceConnectionStates.done),n(AdapterJS._iceConnectionStates.done)},1e3),n(t));return},createIceServer=null,createIceServers=null,RTCPeerConnection=null,RTCSessionDescription=typeof RTCSessionDescription=="function"?RTCSessionDescription:null,RTCIceCandidate=typeof RTCIceCandidate=="function"?RTCIceCandidate:null,getUserMedia=null,attachMediaStream=null,reattachMediaStream=null,webrtcDetectedBrowser=null,webrtcDetectedVersion=null,webrtcMinimumVersion=null;var enterif=!0;isdebugversion===!0&&(enterif=!1);if(enterif!==!0||!(navigator.mozGetUserMedia||navigator.webkitGetUserMedia||navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))||(navigator.userAgent.match(/android/ig)||[]).length===0&&(navigator.userAgent.match(/chrome/ig)||[]).length===0&&navigator.userAgent.indexOf("Safari/")>0){if(typeof console!="object"||typeof console.log!="function")console={}||console,console.log=function(e){},console.info=function(e){},console.error=function(e){},console.dir=function(e){},console.exception=function(e){},console.trace=function(e){},console.warn=function(e){},console.count=function(e){},console.debug=function(e){},console.count=function(e){},console.time=function(e){},console.timeEnd=function(e){},console.group=function(e){},console.groupCollapsed=function(e){},console.groupEnd=function(e){};AdapterJS.parseWebrtcDetectedBrowser(),isIE=webrtcDetectedBrowser==="IE",AdapterJS.WebRTCPlugin.WaitForPluginReady=function(){while(AdapterJS.WebRTCPlugin.pluginState!==AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY);},AdapterJS.WebRTCPlugin.callWhenPluginReady=function(e){if(AdapterJS.WebRTCPlugin.pluginState===AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY)e();else var t=setInterval(function(){AdapterJS.WebRTCPlugin.pluginState===AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY&&(clearInterval(t),e())},100)},AdapterJS.WebRTCPlugin.setLogLevel=function(e){AdapterJS.WebRTCPlugin.callWhenPluginReady(function(){AdapterJS.WebRTCPlugin.plugin.setLogLevel(e)})},AdapterJS.WebRTCPlugin.injectPlugin=function(){if(document.readyState!=="complete")return;if(AdapterJS.WebRTCPlugin.pluginState!==AdapterJS.WebRTCPlugin.PLUGIN_STATES.INITIALIZING)return;AdapterJS.WebRTCPlugin.pluginState=AdapterJS.WebRTCPlugin.PLUGIN_STATES.INJECTING;if(webrtcDetectedBrowser==="IE"&&webrtcDetectedVersion<=10){var e=document.createDocumentFragment();AdapterJS.WebRTCPlugin.plugin=document.createElement("div"),AdapterJS.WebRTCPlugin.plugin.innerHTML='<object id="'+AdapterJS.WebRTCPlugin.pluginInfo.pluginId+'" type="'+AdapterJS.WebRTCPlugin.pluginInfo.type+'" '+'width="1" height="1">'+'<param name="pluginId" value="'+AdapterJS.WebRTCPlugin.pluginInfo.pluginId+'" /> '+'<param name="windowless" value="false" /> '+'<param name="pageId" value="'+AdapterJS.WebRTCPlugin.pageId+'" /> '+'<param name="onload" value="'+AdapterJS.WebRTCPlugin.pluginInfo.onload+'" />'+'<param name="tag" value="'+AdapterJS.WebRTCPlugin.TAGS.NONE+'" />'+(AdapterJS.options.getAllCams?'<param name="forceGetAllCams" value="True" />':"")+"</object>";while(AdapterJS.WebRTCPlugin.plugin.firstChild)e.appendChild(AdapterJS.WebRTCPlugin.plugin.firstChild);document.body.appendChild(e),AdapterJS.WebRTCPlugin.plugin=document.getElementById(AdapterJS.WebRTCPlugin.pluginInfo.pluginId)}else AdapterJS.WebRTCPlugin.plugin=document.createElement("object"),AdapterJS.WebRTCPlugin.plugin.id=AdapterJS.WebRTCPlugin.pluginInfo.pluginId,isIE?(AdapterJS.WebRTCPlugin.plugin.width="1px",AdapterJS.WebRTCPlugin.plugin.height="1px"):(AdapterJS.WebRTCPlugin.plugin.width="0px",AdapterJS.WebRTCPlugin.plugin.height="0px"),AdapterJS.WebRTCPlugin.plugin.type=AdapterJS.WebRTCPlugin.pluginInfo.type,AdapterJS.WebRTCPlugin.plugin.innerHTML='<param name="onload" value="'+AdapterJS.WebRTCPlugin.pluginInfo.onload+'">'+'<param name="pluginId" value="'+AdapterJS.WebRTCPlugin.pluginInfo.pluginId+'">'+'<param name="windowless" value="false" /> '+(AdapterJS.options.getAllCams?'<param name="forceGetAllCams" value="True" />':"")+'<param name="pageId" value="'+AdapterJS.WebRTCPlugin.pageId+'">'+'<param name="tag" value="'+AdapterJS.WebRTCPlugin.TAGS.NONE+'" />',document.body.appendChild(AdapterJS.WebRTCPlugin.plugin);AdapterJS.WebRTCPlugin.pluginState=AdapterJS.WebRTCPlugin.PLUGIN_STATES.INJECTED},AdapterJS.WebRTCPlugin.isPluginInstalled=function(e,t,n,r,i){if(!isIE){var s=navigator.mimeTypes;for(var o=0;o<s.length;o++)if(s[o].type.indexOf(n)>=0){r();return}i()}else{try{var u=new ActiveXObject(e+"."+t)}catch(a){i();return}r()}},AdapterJS.WebRTCPlugin.defineWebRTCInterface=function(){if(AdapterJS.WebRTCPlugin.pluginState===AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY){console.error("AdapterJS - WebRTC interface has already been defined");return}AdapterJS.WebRTCPlugin.pluginState=AdapterJS.WebRTCPlugin.PLUGIN_STATES.INITIALIZING,AdapterJS.isDefined=function(e){return e!==null&&e!==undefined},createIceServer=function(e,t,n){var r=null,i=e.split(":");return i[0].indexOf("stun")===0?r={url:e,hasCredentials:!1}:i[0].indexOf("turn")===0&&(r={url:e,hasCredentials:!0,credential:n,username:t}),r},createIceServers=function(e,t,n){var r=[];for(var i=0;i<e.length;++i)r.push(createIceServer(e[i],t,n));return r},RTCSessionDescription=function(e){return AdapterJS.WebRTCPlugin.WaitForPluginReady(),AdapterJS.WebRTCPlugin.plugin.ConstructSessionDescription(e.type,e.sdp)},RTCPeerConnection=function(e,t){if(e!==undefined&&e!==null&&!Array.isArray(e.iceServers))throw new Error("Failed to construct 'RTCPeerConnection': Malformed RTCConfiguration");if(typeof t!="undefined"&&t!==null){var n=!1;n|=typeof t!="object",n|=t.hasOwnProperty("mandatory")&&t.mandatory!==undefined&&t.mandatory!==null&&t.mandatory.constructor!==Object,n|=t.hasOwnProperty("optional")&&t.optional!==undefined&&t.optional!==null&&!Array.isArray(t.optional);if(n)throw new Error("Failed to construct 'RTCPeerConnection': Malformed constraints object")}AdapterJS.WebRTCPlugin.WaitForPluginReady();var r=null;if(e&&Array.isArray(e.iceServers)){r=e.iceServers;for(var i=0;i<r.length;i++)r[i].urls&&!r[i].url&&(r[i].url=r[i].urls),r[i].hasCredentials=AdapterJS.isDefined(r[i].username)&&AdapterJS.isDefined(r[i].credential)}if(AdapterJS.WebRTCPlugin.plugin.PEER_CONNECTION_VERSION&&AdapterJS.WebRTCPlugin.plugin.PEER_CONNECTION_VERSION>1)return r&&(e.iceServers=r),AdapterJS.WebRTCPlugin.plugin.PeerConnection(e);var s=t&&t.mandatory?t.mandatory:null,o=t&&t.optional?t.optional:null;return AdapterJS.WebRTCPlugin.plugin.PeerConnection(AdapterJS.WebRTCPlugin.pageId,r,s,o)},MediaStreamTrack=function(){},MediaStreamTrack.getSources=function(e){AdapterJS.WebRTCPlugin.callWhenPluginReady(function(){AdapterJS.WebRTCPlugin.plugin.GetSources(e)})};var e=function(e){if(typeof e!="object"||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if(n==="require"||n==="advanced"||n==="mediaSource")return;var r=typeof e[n]=="object"?e[n]:{ideal:e[n]};r.exact!==undefined&&typeof r.exact=="number"&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):t==="deviceId"?"sourceId":t};if(r.ideal!==undefined){t.optional=t.optional||[];var s={};typeof r.ideal=="number"?(s[i("min",n)]=r.ideal,t.optional.push(s),s={},s[i("max",n)]=r.ideal,t.optional.push(s)):(s[i("",n)]=r.ideal,t.optional.push(s))}r.exact!==undefined&&typeof r.exact!="number"?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(function(e){r[e]!==undefined&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t};getUserMedia=function(t,n,r){var i={};i.audio=t.audio?e(t.audio):!1,i.video=t.video?e(t.video):!1,AdapterJS.WebRTCPlugin.callWhenPluginReady(function(){AdapterJS.WebRTCPlugin.plugin.getUserMedia(i,n,r)})},window.navigator.getUserMedia=getUserMedia,!navigator.mediaDevices&&typeof Promise!="undefined"&&(requestUserMedia=function(e){return new Promise(function(t,n){getUserMedia(e,t,n)})},navigator.mediaDevices={getUserMedia:requestUserMedia,enumerateDevices:function(){return new Promise(function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(n){e(n.map(function(e){return{label:e.label,kind:t[e.kind],id:e.id,deviceId:e.id,groupId:""}}))})})}}),attachMediaStream=function(e,t){if(!e||!e.parentNode)return;var n;t===null?n="":(typeof t.enableSoundTracks!="undefined"&&t.enableSoundTracks(!0),n=t.id);var r=e.id.length===0?Math.random().toString(36).slice(2):e.id,i=e.nodeName.toLowerCase();if(i!=="object"){var s;switch(i){case"audio":s=AdapterJS.WebRTCPlugin.TAGS.AUDIO;break;case"video":s=AdapterJS.WebRTCPlugin.TAGS.VIDEO;break;default:s=AdapterJS.WebRTCPlugin.TAGS.NONE}var o=document.createDocumentFragment(),u=document.createElement("div"),a="";e.className?a='class="'+e.className+'" ':e.attributes&&e.attributes["class"]&&(a='class="'+e.attributes["class"].value+'" '),u.innerHTML='<object id="'+r+'" '+a+'type="'+AdapterJS.WebRTCPlugin.pluginInfo.type+'">'+'<param name="pluginId" value="'+r+'" /> '+'<param name="pageId" value="'+AdapterJS.WebRTCPlugin.pageId+'" /> '+'<param name="windowless" value="true" /> '+'<param name="streamId" value="'+n+'" /> '+'<param name="tag" value="'+s+'" /> '+"</object>";while(u.firstChild)o.appendChild(u.firstChild);var f="",l="";if(e.clientWidth||e.clientHeight)l=e.clientWidth,f=e.clientHeight;else if(e.width||e.height)l=e.width,f=e.height;e.parentNode.insertBefore(o,e),o=document.getElementById(r),o.width=l,o.height=f,e.parentNode.removeChild(e)}else{var c=e.children;for(var h=0;h!==c.length;++h)if(c[h].name==="streamId"){c[h].value=n;break}e.setStreamId(n)}var p=document.getElementById(r);return AdapterJS.forwardEventHandlers(p,e,Object.getPrototypeOf(e)),p},reattachMediaStream=function(e,t){var n=null,r=t.children;for(var i=0;i!==r.length;++i)if(r[i].name==="streamId"){AdapterJS.WebRTCPlugin.WaitForPluginReady(),n=AdapterJS.WebRTCPlugin.plugin.getStreamWithId(AdapterJS.WebRTCPlugin.pageId,r[i].value);break}if(n!==null)return attachMediaStream(e,n);console.log("Could not find the stream associated with this element")},window.attachMediaStream=attachMediaStream,window.reattachMediaStream=reattachMediaStream,window.getUserMedia=getUserMedia,AdapterJS.attachMediaStream=attachMediaStream,AdapterJS.reattachMediaStream=reattachMediaStream,AdapterJS.getUserMedia=getUserMedia,AdapterJS.forwardEventHandlers=function(e,t,n){properties=Object.getOwnPropertyNames(n);for(var r in properties)r&&(propName=properties[r],typeof propName.slice=="function"&&propName.slice(0,2)==="on"&&typeof t[propName]=="function"&&AdapterJS.addEvent(e,propName.slice(2),t[propName]));var i=Object.getPrototypeOf(n);!i||AdapterJS.forwardEventHandlers(e,t,i)},RTCIceCandidate=function(e){return e.sdpMid||(e.sdpMid=""),AdapterJS.WebRTCPlugin.WaitForPluginReady(),AdapterJS.WebRTCPlugin.plugin.ConstructIceCandidate(e.sdpMid,e.sdpMLineIndex,e.candidate)},AdapterJS.addEvent(document,"readystatechange",AdapterJS.WebRTCPlugin.injectPlugin),AdapterJS.WebRTCPlugin.injectPlugin()},AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCb=AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCb||function(){AdapterJS.addEvent(document,"readystatechange",AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCbPriv),AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCbPriv()},AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCbPriv=function(){if(AdapterJS.options.hidePluginInstallPrompt)return;var e=AdapterJS.WebRTCPlugin.pluginInfo.downloadLink;if(e){var t=plugininstalltext;AdapterJS.renderNotificationBar(t,AdapterJS.TEXT.PLUGIN.BUTTON,e)}else AdapterJS.renderNotificationBar(AdapterJS.TEXT.PLUGIN.NOT_SUPPORTED)},AdapterJS.WebRTCPlugin.isPluginInstalled(AdapterJS.WebRTCPlugin.pluginInfo.prefix,AdapterJS.WebRTCPlugin.pluginInfo.plugName,AdapterJS.WebRTCPlugin.pluginInfo.type,AdapterJS.WebRTCPlugin.defineWebRTCInterface,AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCb),AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCbPriv()}else{"use strict";var getUserMedia=null,attachMediaStream=null,reattachMediaStream=null,webrtcDetectedBrowser=null,webrtcDetectedVersion=null,webrtcMinimumVersion=null,webrtcUtils={log:function(){if(typeof module!="undefined"||typeof require=="function"&&typeof define=="function")return;console.log.apply(console,arguments)},extractVersion:function(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}};function trace(e){e[e.length-1]==="\n"&&(e=e.substring(0,e.length-1));if(window.performance){var t=(window.performance.now()/1e3).toFixed(3);webrtcUtils.log(t+": "+e)}else webrtcUtils.log(e)}typeof window=="object"&&(window.HTMLMediaElement&&!("srcObject"in window.HTMLMediaElement.prototype)&&Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return"mozSrcObject"in this?this.mozSrcObject:this._srcObject},set:function(e){"mozSrcObject"in this?this.mozSrcObject=e:(this._srcObject=e,this.src=URL.createObjectURL(e))}}),getUserMedia=window.navigator&&window.navigator.getUserMedia),attachMediaStream=function(e,t){e.srcObject=t},reattachMediaStream=function(e,t){e.srcObject=t.srcObject};if(typeof window=="undefined"||!window.navigator)webrtcUtils.log("This does not appear to be a browser"),webrtcDetectedBrowser="not a browser";else if(navigator.mozGetUserMedia){webrtcUtils.log("This appears to be Firefox"),webrtcDetectedBrowser="firefox",webrtcDetectedVersion=webrtcUtils.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1),webrtcMinimumVersion=31,window.RTCPeerConnection||(window.RTCPeerConnection=function(e,t){if(webrtcDetectedVersion<38&&e&&e.iceServers){var n=[];for(var r=0;r<e.iceServers.length;r++){var i=e.iceServers[r];if(i.hasOwnProperty("urls"))for(var s=0;s<i.urls.length;s++){var o={url:i.urls[s]};i.urls[s].indexOf("turn")===0&&(o.username=i.username,o.credential=i.credential),n.push(o)}else n.push(e.iceServers[r])}e.iceServers=n}return new mozRTCPeerConnection(e,t)},mozRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return arguments.length?mozRTCPeerConnection.generateCertificate.apply(null,arguments):mozRTCPeerConnection.generateCertificate}}),window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate),getUserMedia=function(e,t,n){var r=function(e){if(typeof e!="object"||e.require)return e;var t=[];return Object.keys(e).forEach(function(n){if(n==="require"||n==="advanced"||n==="mediaSource")return;var r=e[n]=typeof e[n]=="object"?e[n]:{ideal:e[n]};(r.min!==undefined||r.max!==undefined||r.exact!==undefined)&&t.push(n),r.exact!==undefined&&(typeof r.exact=="number"?r.min=r.max=r.exact:e[n]=r.exact,delete r.exact);if(r.ideal!==undefined){e.advanced=e.advanced||[];var i={};typeof r.ideal=="number"?i[n]={min:r.ideal,max:r.ideal}:i[n]=r.ideal,e.advanced.push(i),delete r.ideal,Object.keys(r).length||delete e[n]}}),t.length&&(e.require=t),e};return webrtcDetectedVersion<38&&(webrtcUtils.log("spec: "+JSON.stringify(e)),e.audio&&(e.audio=r(e.audio)),e.video&&(e.video=r(e.video)),webrtcUtils.log("ff37: "+JSON.stringify(e))),navigator.mozGetUserMedia(e,t,n)},navigator.getUserMedia=getUserMedia,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:requestUserMedia,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(e){var t=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];e(t)})};if(webrtcDetectedVersion<41){var orgEnumerateDevices=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return orgEnumerateDevices().then(undefined,function(e){if(e.name==="NotFoundError")return[];throw e})}}}else if(navigator.webkitGetUserMedia&&window.webkitRTCPeerConnection){webrtcUtils.log("This appears to be Chrome"),webrtcDetectedBrowser="chrome",webrtcDetectedVersion=webrtcUtils.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2),webrtcMinimumVersion=38,window.RTCPeerConnection=function(e,t){e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy);var n=new webkitRTCPeerConnection(e,t),r=n.getStats.bind(n);return n.getStats=function(e,t,n){var i=this,s=arguments;if(arguments.length>0&&typeof e=="function")return r(e,t);var o=function(e){var t={},n=e.result();return n.forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t};if(arguments.length>=2){var u=function(e){s[1](o(e))};return r.apply(this,[u,arguments[0]])}return new Promise(function(t,n){s.length===1&&e===null?r.apply(i,[function(e){t.apply(null,[o(e)])},n]):r.apply(i,[t,n])})},n},webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return arguments.length?webkitRTCPeerConnection.generateCertificate.apply(null,arguments):webkitRTCPeerConnection.generateCertificate}}),["createOffer","createAnswer"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=this;if(arguments.length<1||arguments.length===1&&typeof arguments[0]=="object"){var n=arguments.length===1?arguments[0]:undefined;return new Promise(function(r,i){t.apply(e,[r,i,n])})}return t.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=arguments,n=this;return new Promise(function(r,i){t.apply(n,[e[0],function(){r(),e.length>=2&&e[1].apply(null,[])},function(t){i(t),e.length>=3&&e[2].apply(null,[t])}])})}});var constraintsToChrome=function(e){if(typeof e!="object"||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if(n==="require"||n==="advanced"||n==="mediaSource")return;var r=typeof e[n]=="object"?e[n]:{ideal:e[n]};r.exact!==undefined&&typeof r.exact=="number"&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):t==="deviceId"?"sourceId":t};if(r.ideal!==undefined){t.optional=t.optional||[];var s={};typeof r.ideal=="number"?(s[i("min",n)]=r.ideal,t.optional.push(s),s={},s[i("max",n)]=r.ideal,t.optional.push(s)):(s[i("",n)]=r.ideal,t.optional.push(s))}r.exact!==undefined&&typeof r.exact!="number"?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(function(e){r[e]!==undefined&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t};getUserMedia=function(e,t,n){return e.audio&&(e.audio=constraintsToChrome(e.audio)),e.video&&(e.video=constraintsToChrome(e.video)),webrtcUtils.log("chrome: "+JSON.stringify(e)),navigator.webkitGetUserMedia(e,t,n)},navigator.getUserMedia=getUserMedia,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:requestUserMedia,enumerateDevices:function(){return new Promise(function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(n){e(n.map(function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}}))})})}});if(!navigator.mediaDevices.getUserMedia)navigator.mediaDevices.getUserMedia=function(e){return requestUserMedia(e)};else{var origGetUserMedia=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return webrtcUtils.log("spec:   "+JSON.stringify(e)),e.audio=constraintsToChrome(e.audio),e.video=constraintsToChrome(e.video),webrtcUtils.log("chrome: "+JSON.stringify(e)),origGetUserMedia(e)}}typeof navigator.mediaDevices.addEventListener=="undefined"&&(navigator.mediaDevices.addEventListener=function(){webrtcUtils.log("Dummy mediaDevices.addEventListener called.")}),typeof navigator.mediaDevices.removeEventListener=="undefined"&&(navigator.mediaDevices.removeEventListener=function(){webrtcUtils.log("Dummy mediaDevices.removeEventListener called.")}),attachMediaStream=function(e,t){webrtcDetectedVersion>=43?e.srcObject=t:typeof e.src!="undefined"?e.src=URL.createObjectURL(t):webrtcUtils.log("Error attaching stream to element.")},reattachMediaStream=function(e,t){webrtcDetectedVersion>=43?e.srcObject=t.srcObject:e.src=t.src}}else if(navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)){webrtcUtils.log("This appears to be Edge"),webrtcDetectedBrowser="edge",webrtcDetectedVersion=webrtcUtils.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),webrtcMinimumVersion=10547;if(window.RTCIceGatherer){var generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},localCName=generateIdentifier(),SDPUtils={};SDPUtils.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},SDPUtils.splitSections=function(e){var t=e.split("\r\nm=");return t.map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},SDPUtils.matchPrefix=function(e,t){return SDPUtils.splitLines(e).filter(function(e){return e.indexOf(t)===0})},SDPUtils.parseCandidate=function(e){var t;e.indexOf("a=candidate:")===0?t=e.substring(12).split(" "):t=e.substring(10).split(" ");var n={foundation:t[0],component:t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]};for(var r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;default:}return n},SDPUtils.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),n!=="host"&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&e.protocol.toLowerCase()==="tcp"&&(t.push("tcptype"),t.push(e.tcpType)),"candidate:"+t.join(" ")},SDPUtils.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.numChannels=t.length===3?parseInt(t[2],10):1,n},SDPUtils.writeRtpMap=function(e){var t=e.payloadType;return e.preferredPayloadType!==undefined&&(t=e.preferredPayloadType),"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(e.numChannels!==1?"/"+e.numChannels:"")+"\r\n"},SDPUtils.parseFmtp=function(e){var t={},n,r=e.substr(e.indexOf(" ")+1).split(";");for(var i=0;i<r.length;i++)n=r[i].trim().split("="),t[n[0].trim()]=n[1];return t},SDPUtils.writeFtmp=function(e){var t="",n=e.payloadType;e.preferredPayloadType!==undefined&&(n=e.preferredPayloadType);if(e.parameters&&e.parameters.length){var r=[];Object.keys(e.parameters).forEach(function(t){r.push(t+"="+e.parameters[t])}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},SDPUtils.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},SDPUtils.writeRtcpFb=function(e){var t="",n=e.payloadType;return e.preferredPayloadType!==undefined&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+" "+e.parameter+"\r\n"}),t},SDPUtils.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:e.substr(7,t-7)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},SDPUtils.getDtlsParameters=function(e,t){var n=SDPUtils.splitLines(e);n=n.concat(SDPUtils.splitLines(t));var r=n.filter(function(e){return e.indexOf("a=fingerprint:")===0})[0].substr(14),i={role:"auto",fingerprints:[{algorithm:r.split(" ")[0],value:r.split(" ")[1]}]};return i},SDPUtils.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},SDPUtils.getIceParameters=function(e,t){var n=SDPUtils.splitLines(e);n=n.concat(SDPUtils.splitLines(t));var r={usernameFragment:n.filter(function(e){return e.indexOf("a=ice-ufrag:")===0})[0].substr(12),password:n.filter(function(e){return e.indexOf("a=ice-pwd:")===0})[0].substr(10)};return r},SDPUtils.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\n"+"a=ice-pwd:"+e.password+"\r\n"},SDPUtils.parseRtpParameters=function(e){var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=SDPUtils.splitLines(e),r=n[0].split(" ");for(var i=3;i<r.length;i++){var s=r[i],o=SDPUtils.matchPrefix(e,"a=rtpmap:"+s+" ")[0];if(o){var u=SDPUtils.parseRtpMap(o),a=SDPUtils.matchPrefix(e,"a=fmtp:"+s+" ");u.parameters=a.length?SDPUtils.parseFmtp(a[0]):{},u.rtcpFeedback=SDPUtils.matchPrefix(e,"a=rtcp-fb:"+s+" ").map(SDPUtils.parseRtcpFb),t.codecs.push(u)}}return t},SDPUtils.writeRtpDescription=function(e,t){var n="";return n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(e){return e.preferredPayloadType!==undefined?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=SDPUtils.writeRtpMap(e),n+=SDPUtils.writeFtmp(e),n+=SDPUtils.writeRtcpFb(e)}),n+="a=rtcp-mux\r\n",n},SDPUtils.writeSessionBoilerplate=function(){return"v=0\r\no=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},SDPUtils.writeMediaSection=function(e,t,n,r){var i=SDPUtils.writeRtpDescription(e.kind,t);i+=SDPUtils.writeIceParameters(e.iceGatherer.getLocalParameters()),i+=SDPUtils.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),n==="offer"?"actpass":"active"),i+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?i+="a=sendrecv\r\n":e.rtpSender?i+="a=sendonly\r\n":e.rtpReceiver?i+="a=recvonly\r\n":i+="a=inactive\r\n";if(e.rtpSender){var s="msid:"+r.id+" "+e.rtpSender.track.id+"\r\n";i+="a="+s,i+="a=ssrc:"+e.sendSsrc+" "+s}return i+="a=ssrc:"+e.sendSsrc+" cname:"+localCName+"\r\n",i},SDPUtils.getDirection=function(e,t){var n=SDPUtils.splitLines(e);for(var r=0;r<n.length;r++)switch(n[r]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[r].substr(2)}return t?SDPUtils.getDirection(t):"sendrecv"},window.RTCIceCandidate||(window.RTCIceCandidate=function(e){return e}),window.RTCSessionDescription||(window.RTCSessionDescription=function(e){return e}),window.RTCPeerConnection=function(e){var t=this;this.onicecandidate=null,this.onaddstream=null,this.onremovestream=null,this.onsignalingstatechange=null,this.oniceconnectionstatechange=null,this.onnegotiationneeded=null,this.ondatachannel=null,this.localStreams=[],this.remoteStreams=[],this.getLocalStreams=function(){return t.localStreams},this.getRemoteStreams=function(){return t.remoteStreams},this.localDescription=new RTCSessionDescription({type:"",sdp:""}),this.remoteDescription=new RTCSessionDescription({type:"",sdp:""}),this.signalingState="stable",this.iceConnectionState="new",this.iceOptions={gatherPolicy:"all",iceServers:[]};if(e&&e.iceTransportPolicy)switch(e.iceTransportPolicy){case"all":case"relay":this.iceOptions.gatherPolicy=e.iceTransportPolicy;break;case"none":throw new TypeError('iceTransportPolicy "none" not supported')}e&&e.iceServers&&e.iceServers.forEach(function(e){if(e.urls){var n;typeof e.urls=="string"?n=e.urls:n=e.urls[0],n.indexOf("transport=udp")!==-1&&t.iceServers.push({username:e.username,credential:e.credential,urls:n})}}),this.transceivers=[],this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype._emitBufferedCandidates=function(){var e=this;this._localIceCandidatesBuffer.forEach(function(t){e.onicecandidate!==null&&e.onicecandidate(t)}),this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype.addStream=function(e){this.localStreams.push(e.clone()),this._maybeFireNegotiationNeeded()},window.RTCPeerConnection.prototype.removeStream=function(e){var t=this.localStreams.indexOf(e);t>-1&&(this.localStreams.splice(t,1),this._maybeFireNegotiationNeeded())},window.RTCPeerConnection.prototype._getCommonCapabilities=function(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]};return e.codecs.forEach(function(e){for(var r=0;r<t.codecs.length;r++){var i=t.codecs[r];if(e.name.toLowerCase()===i.name.toLowerCase()&&e.clockRate===i.clockRate&&e.numChannels===i.numChannels){n.codecs.push(i);break}}}),e.headerExtensions.forEach(function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}}),n},window.RTCPeerConnection.prototype._createIceAndDtlsTransports=function(e,t){var n=this,r=new RTCIceGatherer(n.iceOptions),i=new RTCIceTransport(r);r.onlocalcandidate=function(s){var o={};o.candidate={sdpMid:e,sdpMLineIndex:t};var u=s.candidate;!u||Object.keys(u).length===0?(r.state===undefined&&(r.state="completed"),o.candidate.candidate="candidate:1 1 udp 1 0.0.0.0 9 typ endOfCandidates"):(u.component=i.component==="RTCP"?2:1,o.candidate.candidate=SDPUtils.writeCandidate(u));var a=n.transceivers.every(function(e){return e.iceGatherer&&e.iceGatherer.state==="completed"});n.onicecandidate!==null&&(n.localDescription&&n.localDescription.type===""?(n._localIceCandidatesBuffer.push(o),a&&n._localIceCandidatesBuffer.push({})):(n.onicecandidate(o),a&&n.onicecandidate({})))},i.onicestatechange=function(){n._updateConnectionState()};var s=new RTCDtlsTransport(i);return s.ondtlsstatechange=function(){n._updateConnectionState()},s.onerror=function(){s.state="failed",n._updateConnectionState()},{iceGatherer:r,iceTransport:i,dtlsTransport:s}},window.RTCPeerConnection.prototype._transceive=function(e,t,n){var r=this._getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);t&&e.rtpSender&&(r.encodings=[{ssrc:e.sendSsrc}],r.rtcp={cname:localCName,ssrc:e.recvSsrc},e.rtpSender.send(r)),n&&e.rtpReceiver&&(r.encodings=[{ssrc:e.recvSsrc}],r.rtcp={cname:e.cname,ssrc:e.sendSsrc},e.rtpReceiver.receive(r))},window.RTCPeerConnection.prototype.setLocalDescription=function(e){var t=this;if(e.type==="offer")!this._pendingOffer||(this.transceivers=this._pendingOffer,delete this._pendingOffer);else if(e.type==="answer"){var n=SDPUtils.splitSections(t.remoteDescription.sdp),r=n.shift();n.forEach(function(e,n){var i=t.transceivers[n],s=i.iceGatherer,o=i.iceTransport,u=i.dtlsTransport,a=i.localCapabilities,f=i.remoteCapabilities,l=e.split("\n",1)[0].split(" ",2)[1]==="0";if(!l){var c=SDPUtils.getIceParameters(e,r);o.start(s,c,"controlled");var h=SDPUtils.getDtlsParameters(e,r);u.start(h);var p=t._getCommonCapabilities(a,f);t._transceive(i,p.codecs.length>0,!1)}})}this.localDescription=e;switch(e.type){case"offer":this._updateSignalingState("have-local-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}var i=arguments.length>1&&typeof arguments[1]=="function";if(i){var s=arguments[1];window.setTimeout(function(){s(),t._emitBufferedCandidates()},0)}var o=Promise.resolve();return o.then(function(){i||window.setTimeout(t._emitBufferedCandidates.bind(t),0)}),o},window.RTCPeerConnection.prototype.setRemoteDescription=function(e){var t=this,n=new MediaStream,r=SDPUtils.splitSections(e.sdp),i=r.shift();r.forEach(function(r,s){var o=SDPUtils.splitLines(r),u=o[0].substr(2).split(" "),a=u[0],f=u[1]==="0",l=SDPUtils.getDirection(r,i),c,h,p,d,v,m,g,y,b,w=SDPUtils.parseRtpParameters(r),E,S;f||(E=SDPUtils.getIceParameters(r,i),S=SDPUtils.getDtlsParameters(r,i));var x=SDPUtils.matchPrefix(r,"a=mid:")[0].substr(6),T,N=SDPUtils.matchPrefix(r,"a=ssrc:").map(function(e){return SDPUtils.parseSsrcMedia(e)}).filter(function(e){return e.attribute==="cname"})[0];N&&(y=parseInt(N.ssrc,10),T=N.value);if(e.type==="offer"){var C=t._createIceAndDtlsTransports(x,s);b=RTCRtpReceiver.getCapabilities(a),g=(2*s+2)*1001,m=new RTCRtpReceiver(C.dtlsTransport,a),n.addTrack(m.track);if(t.localStreams.length>0&&t.localStreams[0].getTracks().length>=s){var k=t.localStreams[0].getTracks()[s];v=new RTCRtpSender(k,C.dtlsTransport)}t.transceivers[s]={iceGatherer:C.iceGatherer,iceTransport:C.iceTransport,dtlsTransport:C.dtlsTransport,localCapabilities:b,remoteCapabilities:w,rtpSender:v,rtpReceiver:m,kind:a,mid:x,cname:T,sendSsrc:g,recvSsrc:y},t._transceive(t.transceivers[s],!1,l==="sendrecv"||l==="sendonly")}else e.type==="answer"&&!f&&(c=t.transceivers[s],h=c.iceGatherer,p=c.iceTransport,d=c.dtlsTransport,v=c.rtpSender,m=c.rtpReceiver,g=c.sendSsrc,b=c.localCapabilities,t.transceivers[s].recvSsrc=y,t.transceivers[s].remoteCapabilities=w,t.transceivers[s].cname=T,p.start(h,E,"controlling"),d.start(S),t._transceive(c,l==="sendrecv"||l==="recvonly",l==="sendrecv"||l==="sendonly"),!m||l!=="sendrecv"&&l!=="sendonly"?delete c.rtpReceiver:n.addTrack(m.track))}),this.remoteDescription=e;switch(e.type){case"offer":this._updateSignalingState("have-remote-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}return window.setTimeout(function(){t.onaddstream!==null&&n.getTracks().length&&(t.remoteStreams.push(n),window.setTimeout(function(){t.onaddstream({stream:n})},0))},0),arguments.length>1&&typeof arguments[1]=="function"&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._updateSignalingState("closed")},window.RTCPeerConnection.prototype._updateSignalingState=function(e){this.signalingState=e,this.onsignalingstatechange!==null&&this.onsignalingstatechange()},window.RTCPeerConnection.prototype._maybeFireNegotiationNeeded=function(){this.onnegotiationneeded!==null&&this.onnegotiationneeded()},window.RTCPeerConnection.prototype._updateConnectionState=function(){var e=this,t,n={"new":0,closed:0,connecting:0,checking:0,connected:0,completed:0,failed:0};this.transceivers.forEach(function(e){n[e.iceTransport.state]++,n[e.dtlsTransport.state]++}),n.connected+=n.completed,t="new";if(n.failed>0)t="failed";else if(n.connecting>0||n.checking>0)t="connecting";else if(n.disconnected>0)t="disconnected";else if(n.new>0)t="new";else if(n.connecting>0||n.completed>0)t="connected";t!==e.iceConnectionState&&(e.iceConnectionState=t,this.oniceconnectionstatechange!==null&&this.oniceconnectionstatechange())},window.RTCPeerConnection.prototype.createOffer=function(){var e=this;if(this._pendingOffer)throw new Error("createOffer called while there is a pending offer.");var t;arguments.length===1&&typeof arguments[0]!="function"?t=arguments[0]:arguments.length===3&&(t=arguments[2]);var n=[],r=0,i=0;this.localStreams.length&&(r=this.localStreams[0].getAudioTracks().length,i=this.localStreams[0].getVideoTracks().length);if(t){if(t.mandatory||t.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");t.offerToReceiveAudio!==undefined&&(r=t.offerToReceiveAudio),t.offerToReceiveVideo!==undefined&&(i=t.offerToReceiveVideo)}this.localStreams.length&&this.localStreams[0].getTracks().forEach(function(e){n.push({kind:e.kind,track:e,wantReceive:e.kind==="audio"?r>0:i>0}),e.kind==="audio"?r--:e.kind==="video"&&i--});while(r>0||i>0)r>0&&(n.push({kind:"audio",wantReceive:!0}),r--),i>0&&(n.push({kind:"video",wantReceive:!0}),i--);var s=SDPUtils.writeSessionBoilerplate(),o=[];n.forEach(function(t,n){var r=t.track,i=t.kind,u=generateIdentifier(),a=e._createIceAndDtlsTransports(u,n),f=RTCRtpSender.getCapabilities(i),l,c,h=(2*n+1)*1001;r&&(l=new RTCRtpSender(r,a.dtlsTransport)),t.wantReceive&&(c=new RTCRtpReceiver(a.dtlsTransport,i)),o[n]={iceGatherer:a.iceGatherer,iceTransport:a.iceTransport,dtlsTransport:a.dtlsTransport,localCapabilities:f,remoteCapabilities:null,rtpSender:l,rtpReceiver:c,kind:i,mid:u,sendSsrc:h,recvSsrc:null};var p=o[n];s+=SDPUtils.writeMediaSection(p,p.localCapabilities,"offer",e.localStreams[0])}),this._pendingOffer=o;var u=new RTCSessionDescription({type:"offer",sdp:s});return arguments.length&&typeof arguments[0]=="function"&&window.setTimeout(arguments[0],0,u),Promise.resolve(u)},window.RTCPeerConnection.prototype.createAnswer=function(){var e=this,t;arguments.length===1&&typeof arguments[0]!="function"?t=arguments[0]:arguments.length===3&&(t=arguments[2]);var n=SDPUtils.writeSessionBoilerplate();this.transceivers.forEach(function(t){var r=e._getCommonCapabilities(t.localCapabilities,t.remoteCapabilities);n+=SDPUtils.writeMediaSection(t,r,"answer",e.localStreams[0])});var r=new RTCSessionDescription({type:"answer",sdp:n});return arguments.length&&typeof arguments[0]=="function"&&window.setTimeout(arguments[0],0,r),Promise.resolve(r)},window.RTCPeerConnection.prototype.addIceCandidate=function(e){var t=e.sdpMLineIndex;if(e.sdpMid)for(var n=0;n<this.transceivers.length;n++)if(this.transceivers[n].mid===e.sdpMid){t=n;break}var r=this.transceivers[t];if(r){var i=Object.keys(e.candidate).length>0?SDPUtils.parseCandidate(e.candidate):{};if(i.protocol==="tcp"&&i.port===0)return;if(i.component!=="1")return;i.type==="endOfCandidates"&&(i={}),r.iceTransport.addRemoteCandidate(i)}return arguments.length>1&&typeof arguments[1]=="function"&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.getStats=function(){var e=[];this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(n){t[n]&&e.push(t[n].getStats())})});var t=arguments.length>1&&typeof arguments[1]=="function"&&arguments[1];return new Promise(function(n){var r={};Promise.all(e).then(function(e){e.forEach(function(e){Object.keys(e).forEach(function(t){r[t]=e[t]})}),t&&window.setTimeout(t,0,r),n(r)})})}}}else webrtcUtils.log("Browser does not appear to be WebRTC-capable");function requestUserMedia(e){return new Promise(function(t,n){getUserMedia(e,t,n)})}var webrtcTesting={};try{Object.defineProperty(webrtcTesting,"version",{set:function(e){webrtcDetectedVersion=e}})}catch(e){}AdapterJS.parseWebrtcDetectedBrowser(),navigator.mozGetUserMedia?(MediaStreamTrack.getSources=function(e){setTimeout(function(){var t=[{kind:"audio",id:"default",label:"",facing:""},{kind:"video",id:"default",label:"",facing:""}];e(t)},0)},createIceServer=function(e,t,n){console.warn("createIceServer is deprecated. It should be replaced with an application level implementation.");var r=null,i=e.split(":");if(i[0].indexOf("stun")===0)r={urls:[e]};else if(i[0].indexOf("turn")===0)if(webrtcDetectedVersion<27){var s=e.split("?");if(s.length===1||s[1].indexOf("transport=udp")===0)r={urls:[s[0]],credential:n,username:t}}else r={urls:[e],credential:n,username:t};return r},createIceServers=function(e,t,n){console.warn("createIceServers is deprecated. It should be replaced with an application level implementation.");var r=[];for(i=0;i<e.length;i++){var s=createIceServer(e[i],t,n);s!==null&&r.push(s)}return r}):navigator.webkitGetUserMedia&&(createIceServer=function(e,t,n){console.warn("createIceServer is deprecated. It should be replaced with an application level implementation.");var r=null,i=e.split(":");return i[0].indexOf("stun")===0?r={url:e}:i[0].indexOf("turn")===0&&(r={url:e,credential:n,username:t}),r},createIceServers=function(e,t,n){console.warn("createIceServers is deprecated. It should be replaced with an application level implementation.");var r=[];if(webrtcDetectedVersion>=34)r={urls:e,credential:n,username:t};else for(i=0;i<e.length;i++){var s=createIceServer(e[i],t,n);s!==null&&r.push(s)}return r}),navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)&&(getUserMedia=window.getUserMedia=navigator.getUserMedia.bind(navigator),attachMediaStream=function(e,t){return e.srcObject=t,e},reattachMediaStream=function(e,t){return e.srcObject=t.srcObject,e}),attachMediaStream_base=attachMediaStream,webrtcDetectedBrowser==="opera"&&(attachMediaStream_base=function(e,t){webrtcDetectedVersion>38?e.srcObject=t:typeof e.src!="undefined"&&(e.src=URL.createObjectURL(t))}),attachMediaStream=function(e,t){return webrtcDetectedBrowser!=="chrome"&&webrtcDetectedBrowser!=="opera"||!!t?attachMediaStream_base(e,t):e.src="",e},reattachMediaStream_base=reattachMediaStream,reattachMediaStream=function(e,t){return reattachMediaStream_base(e,t),e},window.attachMediaStream=attachMediaStream,window.reattachMediaStream=reattachMediaStream,window.getUserMedia=getUserMedia,AdapterJS.attachMediaStream=attachMediaStream,AdapterJS.reattachMediaStream=reattachMediaStream,AdapterJS.getUserMedia=getUserMedia,typeof Promise=="undefined"&&(requestUserMedia=null),AdapterJS.maybeThroughWebRTCReady()};